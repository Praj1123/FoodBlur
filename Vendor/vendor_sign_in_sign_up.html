<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vendor Interface</title>
    <link rel="stylesheet" href="stylesheet.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>

<body>
    <div class="color1 mb-4" style="width: 100%;height: 100%;">
        <nav class="navbar color2">
            <div class="color2 w-25" style="text-align: left;margin-left: 25px;">
                <a class="navbar-brand" href="#">
                    <img src="/images/BrandLogo.png" alt="Logo" width="140" height="45" class="d-inline-block align-text-top">
                </a>
            </div>
        </nav>
    </div>

    <div class="container">
        <div class="bd-example" id="sign_in_card" style="margin: 20px">
            <div class="card p-5 shadow-lg">
                <div class="card-title" style="text-align: center;color: #F55951;">
                    <h4>Sign in</h4>
                </div>
                <form class="needs-validation" novalidate>
                    <div class="mb-3">
                        <label for="exampleInputEmail1" class="form-label">Email address</label>
                        <input type="email" class="form-control" aria-describedby="emailHelp" fdprocessedid="k3rd4q"
                            id="sign_in_email" required>
                        <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
                    </div>
                    <div class="mb-3">
                        <label for="exampleInputPassword1" class="form-label">Password</label>
                        <input type="password" class="form-control" fdprocessedid="ojxdpk" id="sign_in_password">
                    </div>

                    <div class="spinner-border text-dark" role="status" id="loader1"
                        style="display: none;margin:0 auto;">
                        <span class="visually-hidden">Loading...</span>
                    </div>

                    <button type="button" class="btn" fdprocessedid="akrb9m"
                        style="background-color: #F55951;color: white;" id="signIn">Sign in</button>
                    <div style="text-align: center;">
                        <h4>OR</h4>
                        <p>Don't have account ? <a style="text-decoration: none;"><b
                                    style="color: #F55951;" id="sign_up_btn">Sign up</b></a>
                        </p>
                    </div>
                </form>
            </div>
        </div>
        <div class="bd-example" id="sign_up_card" style="margin: 20px;display: none;">
            <div class="card p-5 shadow-lg">
                <div class="card-title" style="text-align: center;color: #F55951;">
                    <h4>Sign up</h4>
                </div>
                <form class="needs-validation" novalidate>
                    <div class="mb-3">
                        <label for="exampleInputEmail1" class="form-label">Email address</label>
                        <input type="email" class="form-control" aria-describedby="emailHelp" fdprocessedid="k3rd4q"
                            id="sign_up_email" required>
                        <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
                    </div>
                    <div class="mb-3">
                        <label for="exampleInputPassword1" class="form-label">Password</label>
                        <input type="password" class="form-control" fdprocessedid="ojxdpk" id="sign_up_password">
                    </div>

                    <div class="spinner-border text-dark" role="status" id="loader1"
                        style="display: none;margin:0 auto;">
                        <span class="visually-hidden">Loading...</span>
                    </div>

                    <button type="button" class="btn" fdprocessedid="akrb9m"
                        style="background-color: #F55951;color: white;" id="sign_up">Sign up</button>
                    <div style="text-align: center;">
                        <h4>OR</h4>
                        <p>Already have account ? <a style="text-decoration: none;"><b
                                    style="color: #F55951;" id="sign_in_btn">Sign in</b></a>
                        </p>
                    </div>
                </form>
            </div>
        </div>

        <div class="card p-2 shadow-lg mt-5" style="display: none;" id="details-card">
            <form class="row g-3 was-validated">

                <div class="alert alert-success" role="alert" id="success-alert2"
                    style="margin: 0 auto;border-radius:0px;display: none;">

                </div>
                <div class="alert alert-danger" role="alert" id="danger-alert2"
                    style="margin: 0 auto;border-radius:0px;display: none;">

                </div>

                <div class="col-md-6">
                    <label for="inputEmail4" class="form-label">Title of your services</label>
                    <input type="text" class="form-control" id="title" placeholder="eg . Priya's Kitchen" required>
                </div>

                <div class="col-md-6">
                    <label for="inputCity" class="form-label">City</label>
                    <select class="form-select" id="city" required>
                        <option value="">Choose...</option>
                        <option value="Wardha">Wardha</option>
                    </select>
                </div>

                <div class="col-md-4">
                    <label for="inputState" class="form-label">State</label>
                    <select id="state" class="form-select" required>
                        <option value="">Choose...</option>
                        <option value="Maharashtra">Maharashtra</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="inputZip" class="form-label">Pin code</label>
                    <input type="text" class="form-control" id="pinCode" required>
                </div>
                <div class="form-check form-switch" style="margin-left: 6px;">
                    <input class="form-check-input" type="checkbox" role="switch" id="switch1" value="lunchBox"
                        onclick="check(),disabledBtn()">
                    <label class="form-check-label" for="flexSwitchCheckDefault">Can you deliver lunch box</label>
                </div>

                <div class="form-check form-switch" style="margin-left: 6px;">
                    <input class="form-check-input" type="checkbox" role="switch" id="switch2" value="dinnerBox"
                        onclick="check(),disabledBtn()">
                    <label class="form-check-label" for="flexSwitchCheckDefault">Can you deliver Dinner box </label>
                </div>
                <div class="form-check form-switch" style="margin-left: 6px;">
                    <input class="form-check-input" type="checkbox" role="switch" id="switch3" value="both"
                        onclick="check(),disabledBtn()">
                    <label class="form-check-label" for="flexSwitchCheckDefault">Can you deliver lunch box and Dinner
                        box both</label>
                </div>
                <div class="col-md-2" id="priceLable1" style="display: none;">
                    <label for="inputZip" class="form-label">Subscription price for lunch box.(per Month)</label>
                    <input type="tel" class="form-control" id="lunchBoxPrice" required>
                </div>
                <div class="col-md-2" id="priceLable2" style="display: none;">
                    <label for="inputZip" class="form-label">Subscription price for dinner box.(per Month)</label>
                    <input type="tel" class="form-control" id="dinnerBoxPrice" required>
                </div>
                <div class="col-md-3" id="priceLable3" style="display: none;">
                    <label for="inputZip" class="form-label">Subscription price for lunch box and dinner box.(per
                        Month)</label>
                    <input type="tel" class="form-control" id="bothBoxPrice" required>
                </div>

                <div class="col-md-3" id="priceLable4" style="display: none;">
                    <label for="inputZip" class="form-label">Subscription price one time lunch box / dinner box.(per
                        Month)</label>
                    <input type="tel" class="form-control" id="oneTimePrice" required>
                </div>

                <div class="col-12">
                    <label for="inputAddress" class="form-label">Address</label>
                    <input type="text" class="form-control" id="address" placeholder="1234 Main St" required>
                </div>
                <div class="mb-3">
                    <label for="exampleFormControlTextarea1" class="form-label">Description</label>
                    <textarea class="form-control" id="description" rows="3" required></textarea>
                </div>
                <div class="preview col-md-6">
                    <div class="preview-pic tab-content">
                        <div class="tab-pane active" id="pic-1"><img src="BrandLogo.png" class="shadow-lg" width="100%"
                                height="200px" id="preview-image" style="border-radius: 10px;max-width: 350px;">
                        </div>
                    </div>

                </div>
                <label for="inputAddress" class="form-label">Upload only one image of your Product</label>
                <div class="input-group">
                    <input type="file" class="form-control" id="image-file" aria-describedby="inputGroupFileAddon04"
                        aria-label="Upload" onchange="showPreview()" required>
                </div>
                <div class="spinner-border text-warning mt-5 mb-2" id="loader" role="status"
                    style="text-align: center;margin: 0 auto;display: none;">
                </div>
                <div class="col-12 mb-3 ml-2">
                    <button type="button" id="saveData" class="btn"
                        style="background-color: #F55951;color: white;">Save</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyChtcoj-0g8LcHXW26Tyqkm_7Xxj8jG5Ow",
            authDomain: "food-blur.firebaseapp.com",
            projectId: "food-blur",
            storageBucket: "food-blur.appspot.com",
            messagingSenderId: "911842353467",
            appId: "1:911842353467:web:3107951f8434294e96571e",
            measurementId: "G-9WG8FE55NE"
        };

        firebase.initializeApp(firebaseConfig);
        const dataRef = firebase.firestore();
        const storage = firebase.storage();


        function setDataInDatabase(item, itemPrice, URL, itemOneTimePrice) {
            var title = document.getElementById("title").value;
            var city = document.getElementById("city").value;
            var state = document.getElementById("state").value;
            var pinCode = document.getElementById("pinCode").value;
            var address = document.getElementById("address").value;
            var description = document.getElementById("description").value;
            var file = document.getElementById("image-file").files[0];
            dataRef.collection('vendors').doc(localStorage.getItem("userDataId")).set({
                Title: title,
                City: city,
                State: state,
                Pincode: pinCode,
                Address: address,
                Description: description,
                Item: item,
                Itemprice: itemPrice,
                item_one_time_price: itemOneTimePrice,
                ItemURL: URL
            }).then(() => {
                document.getElementById("loader").style.display = "none";
                document.getElementById("success-alert2").innerHTML = "Information saved successfully";
                setTimeout(() => {
                    document.getElementById("success-alert2").style.display = "none";
                }, 7000)
                console.log("Data set successfully");
            }).catch((error) => {
                document.getElementById("loader").style.display = "none";
                document.getElementById("danger-alert2").innerHTML = error;
                setTimeout(() => {
                    document.getElementById("danger-alert2").style.display = "none";
                    window.location.reload(true);
                }, 7000)
                console.log(error);
            })
        }


        function uploadImageFile(item, itemPrice, itemOneTimePrice) {
            document.getElementById("loader").style.display = "block";
            var URL;
            var file = document.getElementById("image-file").files[0];
            storage.ref().child(file.name).put(file).then((snapshot) => {
                storage.ref().child(file.name).getDownloadURL().then((url) => {
                    URL = url;
                    console.log(url);
                    document.getElementById("success-alert2").style.display = "block";
                    document.getElementById("success-alert2").innerHTML = "Image uploaded successfully";
                    console.log("Image uploaded successfully");
                    setDataInDatabase(item, itemPrice, URL, itemOneTimePrice);
                })
            })
        }

        document.getElementById("saveData").addEventListener("click", function () {
            var title = document.getElementById("title").value;
            var city = document.getElementById("city").value;
            var state = document.getElementById("state").value;
            var pinCode = document.getElementById("pinCode").value;
            var lunchBox = document.getElementById("switch1").checked;
            var dinnerBox = document.getElementById("switch2").checked;
            var both = document.getElementById("switch3").checked;
            var lunchBoxPrice = document.getElementById("lunchBoxPrice").value;
            var dinnerBoxPrice = document.getElementById("dinnerBoxPrice").value;
            var bothBoxPrice = document.getElementById("bothBoxPrice").value;
            var oneTimePrice = document.getElementById("oneTimePrice").value;
            var address = document.getElementById("address").value;
            var description = document.getElementById("description").value;
            var file = document.getElementById("image-file").files[0];
            var item;
            var itemPrice;
            if (title == "") {
                alert("Services title required");
            } else {
                if (city == "") {
                    alert("Select your city");
                } else {
                    if (state == "") {
                        alert("Select your state");
                    } else {
                        if (pinCode == "") {
                            alert("Pin code required");
                        } else {
                            if (lunchBox == false && dinnerBox == false && both == false) {
                                alert("Select check box");
                            } else {
                                if (lunchBox == true && dinnerBox == true && both == true) {
                                    alert("Cannot select all check boxes , select anyone...")
                                } else {
                                    if (lunchBox == true && lunchBoxPrice == "") {
                                        item = lunchBox;
                                        alert("Enter lunch box price");
                                    } else {
                                        if (dinnerBox == true && dinnerBoxPrice == "") {
                                            item = dinnerBox;
                                            alert("Enter dinner box price");
                                        } else {
                                            if (both == true && bothBoxPrice == "" && oneTimePrice == "") {
                                                item = both;
                                                alert("Enter Lunch box and dinner box price");
                                            } else {
                                                if (address == "") {
                                                    alert("Address required");
                                                } else {
                                                    if (description == "") {
                                                        alert("Description required");
                                                    } else {
                                                        if (file == undefined) {
                                                            alert("Upload single image of your product");
                                                        } else {
                                                            if (lunchBox == true) {
                                                                item = "lunch Box";
                                                                itemPrice = document.getElementById("lunchBoxPrice").value;
                                                                itemOneTimePrice = null;
                                                            } else if (dinnerBox == true) {
                                                                item = "Dinner Box";
                                                                itemPrice = document.getElementById("dinnerBoxPrice").value;
                                                                itemOneTimePrice = null;
                                                            } else if (both == true) {
                                                                item = "Lunch box and dinner box both";
                                                                itemPrice = document.getElementById("bothBoxPrice").value;
                                                                itemOneTimePrice = document.getElementById("oneTimePrice").value;
                                                            } else {
                                                                console.log("error");
                                                            }
                                                            uploadImageFile(item, itemPrice, itemOneTimePrice);
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }

                            }
                        }
                    }
                }
            }



        })
        function showPreview() {
            var file = document.getElementById("image-file").files[0];
            console.log(file.lenght);
            var preview = document.getElementById("preview-image");
            let reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => {
                preview.setAttribute("src", reader.result);
            }
        }


        function check() {
            var switch1 = document.getElementById("switch1").checked;
            var switch2 = document.getElementById("switch2").checked;
            var switch3 = document.getElementById("switch3").checked;
            var priceLable1 = document.getElementById("priceLable1");
            var priceLable2 = document.getElementById("priceLable2");
            var priceLable3 = document.getElementById("priceLable3");
            var priceLable4 = document.getElementById("priceLable4");
            if (switch1 == true) {
                priceLable1.style.display = "inline-block";
                priceLable2.style.display = "none";
                priceLable3.style.display = "none";
                priceLable4.style.display = "none";
            } else if (switch2 == true) {
                priceLable1.style.display = "none";
                priceLable2.style.display = "inline-block";
                priceLable3.style.display = "none";
                priceLable4.style.display = "none";
            } else if (switch3) {
                priceLable1.style.display = "none";
                priceLable2.style.display = "none";
                priceLable3.style.display = "inline-block";
                priceLable4.style.display = "inline-block";
            } else {
                priceLable1.style.display = "none";
                priceLable2.style.display = "none";
                priceLable3.style.display = "none";
                priceLable4.style.display = "none";
            }
        }
    </script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.18.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.18.0/firebase-analytics.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.18.0/firebase-auth.js";
        var firebaseConfig = {
            apiKey: "AIzaSyChtcoj-0g8LcHXW26Tyqkm_7Xxj8jG5Ow",
            authDomain: "food-blur.firebaseapp.com",
            projectId: "food-blur",
            storageBucket: "food-blur.appspot.com",
            messagingSenderId: "911842353467",
            appId: "1:911842353467:web:3107951f8434294e96571e",
            measurementId: "G-9WG8FE55NE"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth();

        document.getElementById("signIn").addEventListener("click", function () {
            var email = document.getElementById("sign_in_email").value;
            var password = document.getElementById("sign_in_password").value;
            if (email == "") {
                alert("Email required");
            } else {
                if (password == "") {
                    alert("Password required");
                } else {
                    signIn(email, password);
                }
            }
        })

        document.getElementById("sign_up").addEventListener("click", function () {
            var email = document.getElementById("sign_up_email").value;
            var password = document.getElementById("sign_up_password").value;
            if (email == "") {
                alert("Email required");
            } else {
                if (password == "") {
                    alert("Password required");
                } else {
                    sign_up(email, password);
                }
            }
        })

        function sign_up(email, password) {
            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    // Signed in 
                    const user = userCredential.user;
                    console.log("sign up successfull");
                    alert('Sign up Successfully, Sign in with same email and password')
                    window.location.reload(true)
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.log(errorMessage);
                    alert(errorMessage)
                });
        }


        function signIn(email, password) {
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    // Signed in 
                    const user = userCredential.user;
                    console.log("sign in successfull");
                    alert('Sign in Successfully')
                    checkStatus();
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.log(errorMessage);
                    alert(errorMessage)
                });
        }

        function checkStatus() {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    const uid = user.uid;
                    localStorage.setItem("VendorDataId", uid)
                    window.location.replace('/Vendor/Dashboard.html')
                    console.log(uid);
                } else {
                    console.log("User is sign out");
                }
            });
        }

        document.getElementById('sign_up_btn').addEventListener('click',()=>{
            document.getElementById('sign_in_card').style.display='none'
            document.getElementById('sign_up_card').style.display='block'
        })

        document.getElementById("sign_in_btn").addEventListener('click',()=>{
            document.getElementById('sign_in_card').style.display='block'
            document.getElementById('sign_up_card').style.display='none'
        })
    </script>
</body>

</html>